<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CashyAds - Premium Ads</title>
    
    <!-- Telegram Web App -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- âœ… RICHINFO TELEGRAM ADS SDK (YOUR CODES) -->
    <script src="https://richinfo.co/richpartners/telegram/js/tg-ob.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            color: white; padding: 20px;
        }
        .container { text-align: center; max-width: 400px; width: 100%; }
        .logo { font-size: 64px; margin-bottom: 20px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .title { font-size: 28px; font-weight: bold; margin-bottom: 10px; }
        .subtitle { font-size: 16px; opacity: 0.9; margin-bottom: 30px; }
        .status { font-size: 18px; margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 12px; backdrop-filter: blur(10px); }
        .success { background: rgba(46,213,115,0.2); border: 2px solid #2ed573; }
        .progress { width: 100%; height: 8px; background: rgba(255,255,255,0.2); border-radius: 10px; overflow: hidden; margin-top: 20px; }
        .progress-bar { height: 100%; background: linear-gradient(90deg,#2ed573,#26de81); width: 0%; transition: width 0.3s ease; }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ðŸ’Ž</div>
        <div class="title" id="title">Loading Premium Ads...</div>
        <div class="subtitle" id="subtitle">Powered by RichAds Network</div>
        <div class="status" id="status">Initializing high-paying ads...</div>
        <div class="progress">
            <div class="progress-bar" id="progress"></div>
        </div>
    </div>

    <script>
        // CONFIG - YOUR VPS
        const CONFIG = {
            API_URL: 'https://YOUR_VPS_IP:8000/cashyads/ad-completed',
            PUB_ID: "993542",     // YOUR pubId
            APP_ID: "4642"        // YOUR appId
        };
        
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand(); tg.disableVerticalSwipes();
        
        const initData = tg.initDataUnsafe;
        const userId = initData?.user?.id;
        const statusEl = document.getElementById('status');
        const progressEl = document.getElementById('progress');
        const titleEl = document.getElementById('title');
        
        function log(message, type = 'info') {
            console.log(`[${type.toUpperCase()}] ${message}`);
            statusEl.textContent = message;
            statusEl.classList.remove('success');
            if (type === 'success') statusEl.classList.add('success');
        }
        
        function updateProgress(percent) {
            progressEl.style.width = percent + '%';
        }
        
        async function notifyBackend(result) {
            try {
                log('ðŸ”„ Processing â‚¹3-5 reward...', 'info');
                updateProgress(90);
                
                const response = await fetch(CONFIG.API_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: userId,
                        result: result,
                        network: 'richinfo',
                        pub_id: CONFIG.PUB_ID
                    })
                });
                
                const data = await response.json();
                titleEl.textContent = 'âœ… Money Added!';
                log(`ðŸŽ‰ +â‚¹${data.reward || 4}! Balance: â‚¹${data.new_balance || '?'}`, 'success');
                updateProgress(100);
                
                tg.HapticFeedback.notificationOccurred('success');
                setTimeout(() => tg.close(), 3000);
            } catch (error) {
                log('âŒ Payment error', 'error');
                setTimeout(() => tg.close(), 4000);
            }
        }
        
        // âœ… YOUR RICHINFO SDK - PERFECT INTEGRATION
        async function initRichAds() {
            try {
                if (!userId) {
                    log('âŒ User not found', 'error');
                    return;
                }
                
                log('ðŸ”„ Loading RichAds...', 'info');
                updateProgress(30);
                
                // YOUR SDK INITIALIZATION
                window.TelegramAdsController = new TelegramAdsController();
                window.TelegramAdsController.initialize({
                    pubId: CONFIG.PUB_ID,  // 993542
                    appId: CONFIG.APP_ID   // 4642
                });
                
                log('âœ… RichAds initialized!', 'success');
                updateProgress(70);
                
                // Show ad after 2s
                setTimeout(() => {
                    titleEl.textContent = 'ðŸŽ¬ Premium Ad Ready!';
                    log('â–¶ï¸ Showing high-paying ad...', 'info');
                    
                    // RichInfo shows ad automatically OR trigger manually
                    window.TelegramAdsController.showAd().then(() => {
                        log('âœ… Ad completed!', 'success');
                        notifyBackend('completed');
                    }).catch(() => {
                        log('âš ï¸ Ad closed', 'info');
                        notifyBackend('viewed');
                    });
                }, 2000);
                
            } catch (error) {
                log(`âŒ SDK Error: ${error.message}`, 'error');
                notifyBackend('debug'); // Test reward
            }
        }
        
        // START
        log('ðŸš€ CashyAds x RichAds', 'info');
        window.addEventListener('load', () => {
            tg.HapticFeedback.impactOccurred('medium');
            setTimeout(initRichAds, 1200);
        });
    </script>
</body>
</html>
